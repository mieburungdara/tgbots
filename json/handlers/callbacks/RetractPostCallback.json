{
  "class_name": "RetractPostCallback",
  "implements": "CallbackCommandInterface",
  "summary": "Menarik kembali (menghapus) sebuah post dari channel publik.",
  "description": "Callback ini memungkinkan penjual untuk menghapus post konten mereka dari channel. Ini akan menghapus pesan dari Telegram dan mengubah status paket menjadi 'deleted'.",
  "dependencies": [
    "MediaPackageRepository",
    "ChannelPostPackageRepository"
  ],
  "methods": [
    {
      "name": "execute",
      "description": "Menjalankan logika penarikan post dalam sebuah transaksi database.",
      "parameters": [
        {
          "name": "app",
          "type": "App"
        },
        {
          "name": "callback_query",
          "type": "array"
        },
        {
          "name": "public_id",
          "type": "string"
        }
      ],
      "logic_flow": [
        "1. Memulai transaksi database.",
        "2. Validasi kepemilikan post.",
        "3. Cari data post di `channel_post_packages` untuk mendapatkan `channel_id` dan `message_id`.",
        "4. Panggil `TelegramAPI::deleteMessage()` untuk menghapus post dari channel.",
        "5. Panggil `MediaPackageRepository::updateStatus()` untuk mengubah status paket menjadi 'deleted'.",
        "6. Edit pesan asli untuk mengonfirmasi bahwa post telah ditarik.",
        "7. Commit transaksi."
      ]
    }
  ]
}
