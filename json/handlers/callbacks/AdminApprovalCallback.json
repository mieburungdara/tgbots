{
  "class_name": "AdminApprovalCallback",
  "implements": "CallbackCommandInterface",
  "summary": "Menangani aksi saat admin menyetujui sebuah kiriman moderasi.",
  "description": "Callback ini dipicu ketika admin menekan tombol \"Setujui\". Ini akan mengubah status post menjadi 'available', mempublikasikannya ke channel yang sesuai, dan memberi notifikasi kepada pengguna.",
  "dependencies": [
    "MediaPackageRepository",
    "ChannelPostPackageRepository"
  ],
  "methods": [
    {
      "name": "execute",
      "description": "Menjalankan logika persetujuan dalam sebuah transaksi database.",
      "parameters": [
        {
          "name": "app",
          "type": "App"
        },
        {
          "name": "callback_query",
          "type": "array"
        },
        {
          "name": "public_id",
          "type": "string",
          "description": "ID publik dari post yang disetujui."
        }
      ],
      "logic_flow": [
        "1. Memulai transaksi database.",
        "2. Cari post berdasarkan `public_id` dan validasi statusnya adalah 'pending'.",
        "3. Ubah status post menjadi 'available' di `media_packages`.",
        "4. Tentukan channel publik tujuan berdasarkan `post_type` dan `category`.",
        "5. Salin media (untuk 'rate') atau kirim teks (untuk 'tanya') ke channel publik.",
        "6. Jika berhasil, kirim notifikasi ke pengguna asli dengan link ke post publik.",
        "7. Buat catatan di `channel_post_packages` untuk menautkan post di channel dengan paket.",
        "8. Edit pesan moderasi asli untuk menandai bahwa post telah disetujui.",
        "9. Commit transaksi."
      ]
    }
  ]
}