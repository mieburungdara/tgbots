{
  "class_name": "RateCallback",
  "implements": "CallbackCommandInterface",
  "summary": "Menyelesaikan proses pemberian rating setelah kategori dipilih.",
  "description": "Callback ini dipicu setelah pengguna memilih kategori (misal: \"Cewek\" atau \"Cowok\") dari tombol inline yang dikirim oleh perintah /rate. Ia akan menyimpan kiriman rating ke database dan mengirimkannya ke channel moderasi untuk ditinjau admin.",
  "methods": [
    {
      "name": "__construct",
      "description": "Menginisialisasi callback dengan instance `App`.",
      "parameters": [{"name": "app", "type": "App", "description": "Objek aplikasi inti."}]
    },
    {
      "name": "execute",
      "description": "Menjalankan logika penyimpanan dan pengiriman rating.",
      "parameters": [
        {"name": "callback_query", "type": "array", "description": "Data callback query asli."}, 
        {"name": "parts", "type": "array", "description": "Data dari callback, misal: `['rate', 'category']`."}
      ],
      "logic_flow": [
        "1. Jawab `callback_query`.",
        "2. Ambil `category` dari `$parts[1]`.",
        "3. Ambil konteks yang disimpan dari state pengguna (berisi `message_id` dan `chat_id` dari media yang di-rate).",
        "4. Reset state pengguna menjadi `null`.",
        "5. Simpan informasi rating (user_id, message_id, category, status='pending') ke tabel `rate_submissions`.",
        "6. Ambil ID channel moderasi dari konfigurasi.",
        "7. Salin media yang di-rate ke channel moderasi menggunakan `TelegramAPI::copyMessage()`.",
        "8. Tambahkan caption pada pesan di channel moderasi yang berisi info rating dan tombol aksi untuk admin (Setujui, Tolak, Ban).",
        "9. Edit pesan asli di chat pengguna untuk memberi konfirmasi bahwa kiriman mereka sedang dimoderasi."
      ]
    }
  ]
}