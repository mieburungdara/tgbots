{
  "class_name": "SaleRepository",
  "purpose": "Repositori untuk mengelola data penjualan (sales). Menyediakan metode untuk membuat catatan penjualan, memeriksa riwayat pembelian, dll.",
  "methods": [
    {
      "name": "__construct",
      "description": "Constructor. Membuat instance SaleRepository.",
      "parameters": [
        {
          "name": "pdo",
          "type": "PDO",
          "description": "Objek koneksi database."
        }
      ]
    },
    {
      "name": "hasUserPurchased",
      "description": "Memeriksa apakah seorang pengguna telah membeli sebuah paket tertentu.",
      "parameters": [
        {
          "name": "package_id",
          "type": "int",
          "description": "ID internal paket."
        },
        {
          "name": "user_id",
          "type": "int",
          "description": "ID Telegram pengguna."
        }
      ],
      "returns": "bool",
      "return_description": "true jika pengguna sudah pernah membeli, false jika belum."
    },
    {
      "name": "createSale",
      "description": "Membuat catatan penjualan baru, mengurangi saldo pembeli, dan menambah saldo penjual. Metode ini harus dijalankan di dalam sebuah transaksi yang dikelola oleh pemanggil.",
      "parameters": [
        {
          "name": "package_id",
          "type": "int",
          "description": "ID paket yang dijual."
        },
        {
          "name": "seller_user_id",
          "type": "int",
          "description": "ID Telegram penjual."
        },
        {
          "name": "buyer_user_id",
          "type": "int",
          "description": "ID Telegram pembeli."
        },
        {
          "name": "price",
          "type": "float",
          "description": "Harga penjualan."
        }
      ],
      "returns": "bool",
      "return_description": "true jika operasi database berhasil.",
      "throws": "Exception Jika terjadi kesalahan database."
    },
    {
      "name": "findPackagesByBuyerId",
      "description": "Menemukan semua paket yang telah dibeli oleh seorang pengguna.",
      "parameters": [
        {
          "name": "buyer_user_id",
          "type": "int",
          "description": "ID Telegram pengguna (pembeli)."
        }
      ],
      "returns": "array",
      "return_description": "Daftar paket yang dibeli, termasuk tanggal pembelian."
    },
    {
      "name": "countSalesForPackage",
      "description": "Menghitung jumlah penjualan untuk sebuah paket tertentu.",
      "parameters": [
        {
          "name": "package_id",
          "type": "int",
          "description": "ID paket."
        }
      ],
      "returns": "int",
      "return_description": "Jumlah penjualan untuk paket tersebut."
    }
  ]
}