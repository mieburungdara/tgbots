{
  "class_name": "MediaPackageRepository",
  "table": "media_packages",
  "summary": "Mengelola entitas paket media, inti dari fitur penjualan.",
  "description": "Repositori ini adalah salah satu yang paling kompleks, bertanggung jawab atas semua operasi terkait paket media. Ini termasuk pembuatan, pencarian, pembaruan harga/deskripsi, penghapusan, dan pemeriksaan status.",
  "methods": [
    {
      "name": "__construct",
      "description": "Menginisialisasi repositori dengan koneksi PDO.",
      "parameters": [{"name": "pdo", "type": "PDO", "description": "Objek koneksi database."}]
    },
    {
      "name": "createPackageWithPublicId",
      "description": "Membuat paket baru, termasuk menghasilkan ID publik yang unik. Ini adalah langkah pertama dalam alur penjualan setelah harga ditetapkan.",
      "parameters": [
        {"name": "seller_user_id", "type": "int", "description": "ID internal pengguna penjual."},
        {"name": "bot_id", "type": "int", "description": "ID internal bot."},
        {"name": "description", "type": "string", "description": "Deskripsi awal paket."},
        {"name": "thumbnail_media_id", "type": "int", "description": "ID dari file media yang akan dijadikan thumbnail."}
      ],
      "logic_flow": [
        "1. Menghasilkan `public_id` unik secara acak.",
        "2. `INSERT INTO media_packages (public_id, telegram_user_id, bot_id, description, thumbnail_media_id, ...)`.",
        "3. Mengembalikan `id` dari paket yang baru dibuat."
      ],
      "returns": "int",
      "return_description": "ID internal paket yang baru."
    },
    {
      "name": "findByPublicId",
      "description": "Mencari paket berdasarkan ID publiknya, yang digunakan di URL dan callback.",
      "parameters": [{"name": "publicId", "type": "string", "description": "ID publik paket."}],
      "logic": "`SELECT * FROM media_packages WHERE public_id = ?`",
      "returns": "array|false"
    },
    {
      "name": "getPackageFiles",
      "description": "Mengambil semua file media yang tergabung dalam sebuah paket.",
      "parameters": [{"name": "package_id", "type": "int", "description": "ID internal paket."}],
      "logic": "`SELECT * FROM media_files WHERE package_id = ?`",
      "returns": "array"
    },
    {
      "name": "updatePrice",
      "description": "Memperbarui harga untuk sebuah paket.",
      "parameters": [
        {"name": "package_id", "type": "int", "description": "ID internal paket."},
        {"name": "price", "type": "int", "description": "Harga baru."}
      ],
      "logic": "`UPDATE media_packages SET price = ? WHERE id = ?`",
      "returns": "bool"
    },
    {
      "name": "hasPendingPost",
      "description": "Memeriksa apakah seorang pengguna memiliki kiriman yang sedang menunggu moderasi (status 'pending').",
      "parameters": [{"name": "user_id", "type": "int", "description": "ID internal pengguna."}],
      "logic": "`SELECT 1 FROM media_packages WHERE telegram_user_id = ? AND status = 'pending' LIMIT 1`",
      "returns": "bool"
    }
  ],
  "notes": "Repositori ini juga memiliki banyak metode lain untuk CRUD, soft/hard delete, dan pembaruan detail lainnya."
}