{
  "flow_name": "/start",
  "summary": "Titik masuk utama bagi pengguna, bisa untuk sambutan atau melihat konten via deep link.",
  "description": "Menangani perintah `/start`. Jika dipanggil tanpa parameter, akan mengirim pesan selamat datang. Jika dipanggil dengan payload `package_...`, akan langsung menampilkan detail paket konten tersebut.",
  "main_flow": {
    "name": "Pengecekan Payload",
    "description": "Memeriksa apakah perintah mengandung payload yang diawali dengan `package_`.",
    "branching": {
      "condition": "Payload `package_` ditemukan.",
      "if_true": {
        "flow": "handleStartWithPayload"
      },
      "if_false": {
        "flow": "handleStartWithoutPayload"
      }
    }
  },
  "sub_flows": [
    {
      "name": "handleStartWithoutPayload",
      "description": "Mengirim pesan sambutan generik kepada pengguna.",
      "steps": [
        {
          "step_number": 1,
          "action": "Kirim pesan selamat datang standar dan anjuran untuk menggunakan /help."
        }
      ]
    },
    {
      "name": "handleStartWithPayload",
      "description": "Menampilkan detail paket konten berdasarkan ID publik dari payload.",
      "logic_flow": [
        "1. Ekstrak `public_id` dari payload.",
        "2. Cari paket menggunakan `MediaPackageRepository::findByPublicId()`.",
        "3. Tentukan peran pengguna (penjual, pembeli, atau pengunjung).",
        "4. **Untuk Penjual**: Tampilkan laporan penjualan lengkap dengan statistik dan tombol aksi (Lihat, Post).",
        "5. **Untuk Pembeli**: Tampilkan pesan bahwa item sudah dimiliki dengan tombol untuk melihat konten.",
        "6. **Untuk Pengunjung**: Tampilkan deskripsi, harga, dan tombol 'Beli Sekarang'.",
        "7. Ambil thumbnail yang valid dan kirim media dengan caption dan tombol yang sesuai."
      ]
    }
  ]
}
