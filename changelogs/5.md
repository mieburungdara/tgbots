
## [5.2.24] - 2025-09-11

### Peningkatan
- **Sinkronisasi Dokumentasi Kritis**: Memperbarui dokumentasi JSON untuk tiga repositori paling kritis (`BotRepository`, `MediaPackageRepository`, `UserRepository`) agar sepenuhnya sinkron dengan kode PHP. Ini memperbaiki puluhan metode dan parameter yang hilang atau tidak akurat.

## [5.2.23] - 2025-09-11

### Peningkatan
- **Sinkronisasi Dokumentasi**: Memperbarui file dokumentasi `json/repositories/AnalyticsRepository.json` agar sepenuhnya sinkron dengan kode PHP di `core/database/AnalyticsRepository.php`. Dokumentasi sekarang mencakup semua metode, parameter, dan logika yang benar.

## [5.2.22] - 2025-09-11

### Diubah
- **Pembaruan Struktur File JSON**: Menambahkan berbagai file konfigurasi JSON baru untuk perintah, handler, dan repositori. Menghapus `alur_sell.md`.

## [5.2.17] - 2025-09-07

### Diperbaiki
- **Syntax Error di CommandRouter.php**: Memperbaiki `syntax error` yang disebabkan oleh penempatan yang salah dari instansiasi `AdminCommand` dan duplikasi inisialisasi array `$this->commands` di `core/handlers/CommandRouter.php`. Logika telah direstrukturisasi untuk memastikan instansiasi yang benar dan menghindari duplikasi.

## [5.2.18] - 2025-09-07

### Fitur
- **Endpoint API getMe untuk Bot**: Menambahkan rute API baru `/api/xoradmin/bots/get-me` yang mengarah ke `Admin/BotController@getMe`. Ini memungkinkan pengambilan informasi bot terbaru dari Telegram API dan memperbarui data bot di database secara langsung melalui endpoint ini.

## [5.2.19] - 2025-09-07

### Diperbaiki
- **Fatal Error Class Not Found di Autoloader**: Memperbaiki masalah `Class not found` untuk kelas-kelas di direktori `handlers/` dan `database/` yang disebabkan oleh penanganan path yang tidak konsisten pada autoloader. Mengubah `strtolower($directoryPath)` menjadi `strtolower(str_replace('\', '/', $directoryPath))` untuk memastikan path direktori selalu dalam huruf kecil dan menggunakan forward slashes, sesuai dengan struktur file pada sistem operasi case-sensitive seperti Linux.

## [5.2.21] - 2025-09-07

### Diperbaiki
- **Syntax Error di StartCommand.php**: Memperbaiki `syntax error` pada baris 66 di `core/handlers/Commands/StartCommand.php` yang disebabkan oleh tanda kutip ganda yang tidak tertutup pada variabel `$caption`, menyebabkan `unexpected variable`.

## [5.2.20] - 2025-09-07

### Diperbaiki
- **Parse Error di Autoloader**: Memperbaiki `parse error` pada `core/autoloader.php` baris 30 yang disebabkan oleh kesalahan escaping backslash dalam string. Mengubah `str_replace('", '/', $directoryPath)` menjadi `str_replace('\', '/', $directoryPath)` untuk memastikan sintaks yang benar.


## [5.2.16] - 2025-09-06

### Diperbaiki
- **Duplikasi Instansiasi AdminCommand**: Merefaktor `CommandRouter.php` untuk menggunakan satu instansi `AdminCommand` untuk perintah `/dev_addsaldo` dan `/feature`, menghilangkan duplikasi dan meningkatkan efisiensi.
- **Duplikasi Teks Perintah Umum**: Merefaktor `HelpCommand.php` untuk menghilangkan duplikasi teks "PERINTAH UMUM" dalam pesan bantuan. Teks umum sekarang didefinisikan sekali dan ditambahkan secara terpusat, sesuai prinsip DRY.

## [5.2.15] - 2025-09-06

### Peningkatan
- **Logging Diagnostik Backup Media**: Menambahkan trace log yang lebih rinci pada alur backup media di `MessageHandler::handleState`.
  - **Tujuan**: Membantu mendiagnosis mengapa media tidak berhasil disalin ke private channel backup, dengan mencatat setiap langkah proses, termasuk pemilihan channel, status penyalinan, dan pembaruan informasi penyimpanan.

## [5.2.14] - 2025-09-06

### Diperbaiki
- **Thumbnail Tidak Ditemukan**: Memperbaiki masalah "Tidak ditemukan thumbnail yang valid" pada paket media.
  - **Penyebab**: `storage_channel_id` dan `storage_message_id` tidak disimpan ke tabel `media_files` setelah media berhasil disalin ke channel penyimpanan pribadi.
  - **Solusi**:
    1.  Memperbarui `MediaFileRepository::saveMediaFile` untuk menyertakan kolom `storage_channel_id` dan `storage_message_id`.
    2.  Menambahkan metode `MediaFileRepository::updateStorageInfo` untuk memperbarui informasi penyimpanan media.
    3.  Memodifikasi `MessageHandler::handleState` untuk memanggil `MediaFileRepository::updateStorageInfo` setelah media berhasil disalin ke channel penyimpanan, memastikan `storage_channel_id` dan `storage_message_id` tercatat dengan benar.

## [5.2.13] - 2025-09-06

### Dokumentasi
- **Alur Fitur /sell**: Menambahkan dokumentasi baru `alur_sell.md` yang menjelaskan secara rinci alur kerja dan logika penggunaan perintah `/sell`.

## [5.2.12] - 2025-09-06

### Diubah
- **Logika Backup Media /sell**: Mengubah alur backup media yang dijual dari channel moderasi ke channel penyimpanan pribadi (private channel). Media sekarang disalin ke channel pribadi pertama yang ditemukan di database `private_channels` setelah harga divalidasi, bukan ke channel yang dikonfigurasi melalui `findSystemChannelByFeature`.

## [5.2.11] - 2025-09-06

### Dokumentasi
- **Alur Perintah /sell**: Merevisi `alur.md` untuk menjelaskan secara lebih mudah dipahami alur kerja dan langkah-langkah untuk memeriksa serta menganalisis bagaimana perintah `/sell` diproses dalam sistem bot, mulai dari penerimaan webhook hingga logika penanganan state pengguna.

## [5.2.10] - 2025-09-05

### Fitur
- **Perintah /about**: Menambahkan perintah baru `/about` yang menampilkan informasi tentang pengembang bot dan menyediakan link kontak untuk kerja sama.

## [5.2.9] - 2025-09-05

### Peningkatan
- **Wizard Pendaftaran Channel**: Formulir pendaftaran channel di panel member telah diubah menjadi format wizard multi-langkah yang lebih interaktif dan menarik, meningkatkan pengalaman pengguna saat menambahkan channel baru.

## [5.2.8] - 2025-09-04

### Diubah
- **Pendaftaran Channel Hanya via Web**: Perintah `/register_channel` telah dihapus dari bot. Pendaftaran dan pengelolaan channel penjualan sekarang hanya dapat dilakukan melalui panel member di website untuk menyederhanakan alur kerja.

## [5.2.7] - 2025-09-04

### Peningkatan
- **Tampilan Nama Channel & Grup**: Pada halaman "Daftar Channel Jualan" di panel member, sekarang nama channel dan nama grup diskusi ditampilkan di samping ID mereka. Ini membuat identifikasi channel menjadi lebih mudah bagi pengguna.
- **Penyimpanan Nama Otomatis**: Logika pendaftaran channel (baik melalui bot maupun web) telah diperbarui untuk secara otomatis mengambil dan menyimpan nama channel dan grup dari Telegram API.
- **Migrasi Data**: Menambahkan skrip migrasi untuk secara otomatis mengisi nama untuk channel dan grup yang sudah terdaftar sebelumnya.

## [5.2.6] - 2025-09-04

### Fitur
- **Dukungan Multi-Channel untuk Penjual**: Member sekarang dapat mendaftarkan dan mengelola beberapa channel penjualan secara bersamaan.
  - Tampilan panel member di `/member/channels` telah diubah untuk menampilkan daftar semua channel yang terdaftar.
  - Member dapat menambahkan channel baru kapan saja, dan menghapus channel yang sudah ada.
  - Fitur "Post ke Channel" sekarang akan menampilkan pilihan channel jika member memiliki lebih dari satu, memberikan kontrol penuh kepada penjual.

## [5.2.5] - 2025-09-04

### Diperbaiki
- **Moderasi Otomatis untuk Fitur /sell**: Memperbaiki alur kerja fitur `/sell` yang sebelumnya secara keliru mengirimkan semua item untuk moderasi manual. Sekarang, item yang dijual melalui `/sell` akan secara otomatis ditandai sebagai `available` dan langsung dapat dibeli, sesuai dengan alur kerja yang diinginkan. Alur moderasi manual kini hanya berlaku untuk fitur `/rate` dan `/tanya`.
- **Logika Channel Penjualan**: Memperbaiki logika saat mendaftarkan channel untuk fitur `/sell` (baik melalui bot maupun web). Kolom `moderation_channel_id` sekarang diatur ke `NULL` dengan benar untuk channel penjualan, karena moderasi tidak berlaku untuk fitur ini. Juga menyertakan migrasi database untuk membersihkan data lama.

## [5.2.4] - 2025-09-04

### Fitur
- **Pemilihan Bot Pengelola Channel**: Member sekarang dapat memilih bot pengelola untuk channel jualan mereka dari daftar bot yang tersedia di halaman `/member/channels`.

## [5.2.3] - 2025-09-04

### Fitur
- **Pendaftaran Channel via Web**: Menambahkan formulir dan logika backend pada halaman `/member/channels` agar member dapat mendaftarkan atau memperbarui channel jualan mereka langsung dari panel member di website.

## [5.2.2] - 2025-09-04

### Fitur
- **Halaman Channel Member**: Menambahkan halaman baru `/member/channels` yang memungkinkan member (penjual) untuk melihat detail channel jualan yang telah mereka daftarkan melalui bot.

## [5.2.1] - 2025-09-04

### Diperbaiki
- **Login Token Tanpa Batas Waktu**: Menghapus validasi masa berlaku token (5 menit) pada alur login member. Token sekarang tidak akan kedaluwarsa, memperbaiki masalah login yang gagal karena token dianggap hangus.

### Diubah
- **Login Token Lebih Fleksibel**: Menghapus pengecekan peran (role) dari alur validasi token di halaman web. Sekarang, semua pengguna yang memiliki token valid dapat login, tidak terbatas hanya pada 'Member'.
- **Alur Perintah /login Disatukan**: Menyatukan respon perintah `/login` di sisi bot. Semua pengguna, terlepas dari perannya, sekarang menerima satu jenis pesan dan tautan login yang konsisten.

## [5.2.0] - 2025-09-04

### Diperbaiki
- **Login Member Gagal**: Memperbaiki masalah kritis yang menghalangi member untuk login menggunakan token. Logika validasi token di `Member/LoginController.php` diganti dengan satu kueri SQL yang andal untuk memeriksa validitas token, masa berlaku, dan peran 'Member' secara bersamaan di level database.

### Diubah
- **Implementasi Ulang Panel Admin**: Panel admin telah diimplementasikan ulang dengan arsitektur multi-halaman yang lebih standar dan aman.
  - **URL**: Semua halaman admin sekarang diakses melalui prefix `/xoradmin/`.
  - **Otentikasi**: Sistem login token untuk admin telah digantikan dengan halaman login berbasis kata sandi statis (`/xoradmin/login`).
  - **Navigasi**: Panel admin sekarang menggunakan layout terpusat dengan sidebar navigasi yang terorganisir untuk semua fitur.

## [5.1.31] - 2025-09-03

### Fitur
- **Pemeriksa Skema Database Komprehensif**: Menambahkan fitur canggih di `Admin > Database > Periksa Skema` untuk membandingkan skema database live dengan file `updated_schema.sql`.
  - **Deteksi Perbedaan Total**: Alat ini sekarang tidak hanya mendeteksi tabel atau kolom yang hilang, tetapi juga mendeteksi:
    - Tabel tambahan di database live yang tidak ada di skema.
    - Kolom tambahan di tabel live yang tidak ada di skema.
    - Kolom yang definisinya (tipe data, nullability, default, dll.) tidak cocok antara database live dan skema.
  - **Generasi Query Otomatis**: Untuk setiap perbedaan yang ditemukan, sistem secara otomatis menghasilkan query SQL (`CREATE TABLE`, `DROP TABLE`, `ALTER TABLE ADD/DROP/MODIFY`) yang dapat disalin oleh admin untuk menyinkronkan database secara manual.
  - **Tampilan Laporan yang Jelas**: Halaman hasil telah didesain ulang total untuk menyajikan semua perbedaan dalam format yang terstruktur dan mudah dibaca, dipisahkan berdasarkan jenisnya.

## [5.1.30] - 2025-09-01

### Diperbaiki
- **Fatal Error `Class not found` (Global Repositories)**: Memperbaiki serangkaian error fatal `Class ... not found` yang terjadi di berbagai bagian aplikasi karena file-file Repository di `core/database/` tidak memiliki deklarasi namespace yang benar.
  - **Penyebab**: Beberapa file repository (`RoleRepository`, `PrivateChannelBotRepository`, `PrivateChannelRepository`, `SaleRepository`, `SellerSalesChannelRepository`) tidak mendeklarasikan `namespace TGBot\Database;` dan tidak mengimpor dependensi seperti `PDO` dengan benar.
  - **Solusi**: Melakukan audit dan perbaikan global pada semua file di `core/database/` untuk memastikan setiap file memiliki deklarasi `namespace` dan pernyataan `use` yang lengkap dan benar, menstabilkan proses autoloading di seluruh aplikasi.

## [5.1.29] - 2025-09-01

### Fitur
- **Fatal Error `Interface not found` (Global)**: Memperbaiki serangkaian error fatal `Interface "TGBot\Handlers\HandlerInterface" not found` yang terjadi di semua file handler.
  - **Penyebab**: File `core/handlers/HandlerInterface.php` tidak memiliki deklarasi namespace, dan semua file handler yang mengimplementasikannya (`MessageHandler`, `CallbackQueryHandler`, dll.) tidak mengimpor interface tersebut dengan benar menggunakan pernyataan `use`.
  - **Solusi**:
    1.  Menambahkan `namespace TGBot\Handlers;` dan `use TGBot\App;` ke `HandlerInterface.php`.
    2.  Menambahkan `use TGBot\Handlers\HandlerInterface;` ke semua kelas handler yang relevan untuk memastikan konsistensi dan autoloading yang benar.

## [5.1.26] - 2025-09-01

### Diperbaiki
- **Fatal Error `Class not found` (UpdateDispatcher)**: Memperbaiki fatal error `Class "TGBot\UpdateHandler" not found` di `core/UpdateDispatcher.php`.
  - **Penyebab**: File `core/UpdateDispatcher.php` tidak mengimpor kelas `UpdateHandler` dengan benar menggunakan pernyataan `use`.
  - **Solusi**: Menambahkan `use TGBot\Handlers\UpdateHandler;` ke bagian atas file `core/UpdateDispatcher.php` untuk memastikan kelas tersebut dapat ditemukan oleh autoloader.

## [5.1.25] - 2025-09-01

### Peningkatan
- **Logging Diagnostik di Webhook**: Menambahkan logging yang lebih detail di `WebhookController.php` untuk membantu mendiagnosis masalah 500 Internal Server Error yang persisten.
  - **Detail Log**: Sistem sekarang akan mencatat ID bot yang memanggil, data bot yang ditemukan di database, dan payload JSON mentah yang diterima dari Telegram. Ini akan memberikan visibilitas penuh pada alur eksekusi webhook untuk identifikasi masalah yang lebih cepat.

## [5.1.24] - 2025-09-01

### Diperbaiki
- **Fatal Error `Class not found` (Autoloader)**: Memperbaiki autoloader di `core/autoloader.php` yang gagal menemukan kelas di subdirektori karena masalah case-sensitivity pada sistem file Linux.
  - **Penyebab**: Autoloader tidak mengubah namespace menjadi huruf kecil saat membuat path file, sehingga `TGBot\Database\BotRepository` dicari di `core/Database/` padahal direktori sebenarnya adalah `core/database/`.
  - **Solusi**: Menambahkan `strtolower()` pada path relatif untuk memastikan path yang dihasilkan selalu huruf kecil, sesuai dengan struktur direktori.

## [5.1.23] - 2025-09-01

### Diperbaiki
- **Fatal Error `Class not found` (Autoloader)**: Merombak total `core/autoloader.php` untuk memperbaiki serangkaian error fatal `Class not found` yang terjadi di seluruh aplikasi, termasuk untuk `TGBot\TelegramAPI` dan `TGBot\Database\BotRepository`.
  - **Penyebab**: Logika autoloader sebelumnya tidak benar-benar mengikuti standar PSR-4. Autoloader gagal menerjemahkan namespace yang mengandung sub-direktori (seperti `TGBot\Database`) ke path file yang benar (`core/database/`) dan salah mengasumsikan semua class berada di direktori `src/` atau `core/` tingkat atas.
  - **Solusi**: Autoloader baru sekarang secara cerdas memetakan namespace ke struktur direktori. Logika baru membedakan antara *Controllers* (di `src/`) dan semua class *Core* lainnya (di `core/`), dan dengan benar mengubah `\` dari namespace ke `/` di path file. Ini memastikan bahwa class seperti `TGBot\Database\BotRepository` sekarang dapat ditemukan di `core/database/BotRepository.php`, menyelesaikan semua masalah autoloading.

## [5.1.21] - 2025-08-31

### Diperbaiki
- **Fatal Error `undefined function` (Final Fix)**: Menambahkan `require_once` untuk `core/database.php` ke dalam `core/autoloader.php`. Ini adalah perbaikan definitif untuk error `Call to undefined function get_db_connection()` yang terus-menerus terjadi.
  - **Penyebab Akar**: Fungsi `get_db_connection()` didefinisikan di `core/database.php`, tetapi file ini tidak pernah di-include oleh autoloader, sehingga tidak tersedia secara global.
  - **Solusi**: Dengan secara eksplisit me-require `core/database.php` di autoloader, fungsi koneksi database sekarang dijamin tersedia untuk semua bagian aplikasi yang membutuhkannya.



### Diperbaiki
- **Diagnostik Tambahan**: Menambahkan kode diagnostik untuk memverifikasi bahwa titik masuk aplikasi (`public/index.php` dan `run_migrations_cli.php`) dieksekusi dengan benar. Ini untuk membantu melacak masalah lingkungan server yang persisten yang menyebabkan error `undefined function`.



### Diperbaiki
- **Fatal Error `undefined function` (Workaround)**: Menambahkan `require_once` untuk `core/helpers.php` secara eksplisit di `BaseController.php` dan `AppController.php`. Ini adalah workaround untuk memastikan fungsi-fungsi helper selalu tersedia, mengatasi error fatal `Call to undefined function` yang dilaporkan oleh pengguna, yang kemungkinan disebabkan oleh masalah lingkungan server.



### Diperbaiki
- **Fatal Error `require_once` dan `undefined function`**: Melakukan refactoring besar dengan mengganti semua pemanggilan `require_once` yang berulang dengan autoloader terpusat. Ini memperbaiki serangkaian error fatal, termasuk `Class not found` dan `Call to undefined function`.
  - **Penyebab**: Ketergantungan pada `require_once` manual menyebabkan file tidak dimuat dalam urutan yang benar, dan pemanggilan fungsi global dari dalam namespace menyebabkan konflik.
  - **Solusi**:
    1.  Membuat `core/autoloader.php` baru yang secara cerdas memuat kelas dari direktori `src` dan `core` berdasarkan namespace `TGBot`.
    2.  Menghapus semua `require_once` yang berlebihan dari seluruh file controller dan file inti.
    3.  Memperbaiki semua pemanggilan fungsi helper global (seperti `get_db_connection`, `app_log`) dengan menambahkan prefix `\` untuk memanggilnya dari namespace global, menyelesaikan semua error `undefined function`.

## [5.1.17] - 2025-08-31

### Diperbaiki
- **Fatal Error Class Not Found**: Memperbaiki error fatal `Class "TGBot\\Controllers\\BaseController" not found` yang terjadi secara sporadis di berbagai controller di dalam panel admin.
  - **Penyebab**: Kurangnya autoloader terpusat (seperti Composer) menyebabkan `BaseController.php` tidak selalu dimuat sebelum controller turunan yang membutuhkannya.
  - **Solusi**: Menambahkan `require_once __DIR__ . \'/../BaseController.php\';` secara eksplisit di semua controller admin yang mewarisi `BaseController`. Ini memastikan kelas dasar selalu tersedia, menstabilkan seluruh panel admin dan mencegah error serupa di masa depan.

## [5.1.16] - 2025-08-30

### Fitur
- **Halaman Laporan Keuangan**: Menambahkan halaman "Laporan Keuangan" baru di panel admin (`/admin/reports/financial`). Halaman ini menampilkan ringkasan pendapatan (harian, mingguan, bulanan, total) serta tabel rincian pendapatan harian dan bulanan, berdasarkan data dari tabel `sales`.

## [5.1.15] - 2025-08-30

### Dokumentasi
- **Dokumentasi Struktur Database**: Menambahkan bagian baru "Struktur Database" ke dalam `DOCUMENTATION.md`. Bagian ini memberikan penjelasan rinci tentang setiap tabel utama (seperti `users`, `bots`, `media_packages`, `sales`) dan kolom-kolomnya, membantu pengembang memahami model data aplikasi.

## [5.1.14] - 2025-08-30

### Dokumentasi
- **Panduan Pembaruan (Upgrade)**: Menambahkan file `UPGRADE.md` baru. File ini menyediakan instruksi langkah-demi-langkah yang aman bagi pengguna untuk memperbarui aplikasi mereka, mencakup proses pencadangan file dan database, penggantian file inti, dan menjalankan migrasi database.

## [5.1.13] - 2025-08-30

### Dokumentasi
- **Panduan Praktik Terbaik**: Menambahkan bagian baru "💡 Praktik Terbaik (Best Practices)" ke dalam `DOCUMENTATION.md`. Bagian ini memberikan tips penting tentang manajemen keamanan (backup, password), pengelolaan konten (channel penyimpanan, deskripsi), dan pemeliharaan rutin (monitoring log, migrasi) untuk membantu pengguna mengelola bot mereka secara efisien dan aman.

## [5.1.12] - 2025-08-30

### Dokumentasi
- **Langkah Verifikasi Instalasi**: Menambahkan bagian "Langkah 7: Verifikasi Instalasi" ke dalam `DOCUMENTATION.md`. Bagian ini memberikan daftar periksa (checklist) bagi pengguna untuk memastikan semua komponen (panel admin, respons bot, koneksi database) berfungsi dengan benar setelah proses instalasi selesai.

## [5.1.11] - 2025-02-30

### Dokumentasi
- **Panduan Troubleshooting**: Menambahkan bagian "Penyelesaian Masalah Umum" (Troubleshooting) baru ke dalam `DOCUMENTATION.md`. Bagian ini memberikan solusi langkah-demi-langkah untuk masalah umum seperti bot yang tidak merespons, error 500, masalah routing URL (`.htaccess`), dan kegagalan koneksi database.

## [5.1.10] - 2025-09-05

### Dokumentasi
- **Konsolidasi Dokumentasi**: Menggabungkan file `INSTALL.md` dan `howto.md` ke dalam satu file `DOCUMENTATION.md` yang komprehensif. File-file lama dihapus untuk menyederhanakan struktur dokumentasi dan menyediakan satu sumber informasi terpusat.

## [5.1.9] - 2025-08-30

### Dokumentasi
- **Panduan Kontributor**: Menambahkan file `CONTRIBUTING.md` baru. File ini berisi panduan lengkap bagi kontributor manusia, mencakup standar kode, alur kerja kontribusi menggunakan Pull Request, format pesan commit, dan cara melaporkan bug. Tujuannya adalah untuk memudahkan kontributor baru bergabung dan menjaga konsistensi proyek.

## [5.1.8] - 2025-08-30

### Refactoring
- **Konsolidasi Panduan Kontribusi**: Menggabungkan beberapa file panduan (`GEMINI.md`, `AGENTS.md`, `.gemini/styleguide.md`) yang tumpang tindih ke dalam satu file `GEMINI.md` tunggal sebagai sumber kebenaran utama. File-file yang berlebihan telah dihapus untuk menyederhanakan dokumentasi proyek dan menghindari kebingungan.

## [5.1.7] - 2025-08-30

### Dokumentasi
- **Panduan Instalasi**: Menambahkan file `INSTALL.md` baru yang berisi panduan lengkap dan terperinci untuk menginstal dan mengkonfigurasi aplikasi dari awal, termasuk pengaturan server, database, dan webhook Telegram.

## [5.1.6] - 2025-08-30

### Peningkatan
- **Keterbacaan Kode Paginasi**: Melakukan refactoring pada logika paginasi di beberapa view admin. Variabel lokal `$currentPage` dan `$totalPages` sekarang didefinisikan di dalam blok paginasi untuk meningkatkan keterbacaan dan menghindari pengulangan, sejalan dengan prinsip DRY dan praktik terbaik kode.

## [5.1.5] - 2025-08-30

### Peningkatan
- **Konsistensi Gaya Kode**: Memperbarui beberapa file view untuk menggunakan tag echo pendek `<?= ... ?>` daripada `<?php echo ...; ?>`. Perubahan ini menyelaraskan kode dengan standar PSR-12 dan praktik yang sudah ada di seluruh proyek, meningkatkan keterbacaan dan konsistensi.

## [5.1.4] - 2025-08-30

### Peningkatan
- **Konsistensi Kode View**: Melakukan refactoring pada `debug_feed/index.php` untuk memastikan konsistensi dengan view lain. Variabel paginasi sekarang diakses langsung dari array `$data['pagination']` daripada mendefinisikan variabel lokal, sejalan dengan praktik terbaik di seluruh aplikasi.

## [5.1.3] - 2025-08-30

### Peningkatan
- **Konsistensi Tipe Exception**: Mengubah tipe `Exception` menjadi `\RuntimeException` di `StorageChannelController` saat terjadi kegagalan penambahan bot ke channel. Perubahan ini membuat penanganan error lebih konsisten dengan bagian lain dari file yang sudah menggunakan `\RuntimeException` untuk error saat runtime.

## [5.1.2] - 2025-08-30

### Diubah (Keamanan)
- **Refactoring View**: Menghapus penggunaan fungsi `extract()` yang berisiko dari `AppController`. Semua variabel sekarang secara eksplisit diakses melalui array `$data` di dalam view (misalnya, `$data['nama_variabel']`). Perubahan ini meningkatkan keamanan dengan mencegah potensi *variable overwriting* dan membuat alur data ke dalam template lebih jelas dan mudah untuk di-debug.

## [5.1.1] - 2025-08-29

### Diperbaiki
- **Penanganan Error Verifikasi Bot**: Menambahkan pemeriksaan error setelah memanggil `addBotToChannel` di dalam `StorageChannelController`. Sebelumnya, jika penambahan bot ke channel gagal di database, sistem akan tetap melanjutkan ke proses verifikasi, yang kemungkinan besar juga akan gagal. Sekarang, sebuah `Exception` akan dilempar lebih awal, memberikan pesan error yang jelas dan mencegah kegagalan berantai.

## [5.1.0] - 2025-08-29

### Peningkatan

- **Pesan Status yang Lebih Akurat**: Memperbaiki logika penambahan peran di `RoleController`. Sistem sekarang memberikan pesan yang jelas kepada pengguna jika peran berhasil ditambahkan, jika peran tersebut sudah ada, atau jika terjadi kesalahan, daripada hanya menampilkan pesan sukses umum.
- **Perbaikan Bug Variabel**: Memperbaiki bug di `RoleController` di mana variabel `$roleRepo` dipanggil alih-alih properti kelas `$this->roleRepo`, yang akan menyebabkan error fatal.
- **Pesan Status Hapus yang Lebih Akurat**: Mengikuti pembaruan sebelumnya, logika penghapusan peran di `RoleController` kini juga telah diperbaiki. Sistem sekarang memberikan pesan yang jelas kepada pengguna jika peran berhasil dihapus, jika peran tidak ditemukan (sehingga tidak ada yang dihapus), atau jika terjadi kesalahan database.

## [5.0.8] - 2025-08-29

### Diperbaiki

- **Penanganan Kesalahan Database**: Memperbaiki blok `catch` yang kosong di `BaseController`. Sebelumnya, kesalahan saat mengambil nama pengguna bot untuk halaman "Akses Ditolak" akan diabaikan secara diam-diam. Sekarang, kesalahan tersebut dicatat menggunakan `app_log()` untuk memastikan semua masalah dapat ditelusuri. (#303)
- **Penanganan Perintah di Grup**: Memperbaiki bug di `MessageHandler` yang menyebabkan bot tidak merespons perintah yang dikirim di dalam grup jika perintah tersebut menyertakan nama bot (misalnya, `/start@nama_bot_saya`). Logika parsing sekarang dengan benar memisahkan perintah dari nama bot, memastikan perintah dikenali dan diproses dengan benar di semua jenis chat.


## [5.0.7] - 2025-08-29

### Peningkatan
- **Refactoring Controller**: Memindahkan inisialisasi `RoleRepository` ke dalam `__construct` di `RoleController`. Ini menghilangkan duplikasi kode di setiap metode dan meningkatkan pemeliharaan dengan mengikuti prinsip DRY.

## [5.0.6] - 2025-08-29

### Diperbaiki (Keamanan)
- **Validasi Input**: Memperkuat keamanan di `RoleController` dengan mengganti pemeriksaan `empty()` yang tidak aman dengan `filter_input(INPUT_POST, 'role_id', FILTER_VALIDATE_INT)`. Ini memastikan bahwa hanya nilai integer yang valid yang diproses saat menghapus peran, mencegah potensi manipulasi input.

## [5.0.5] - 2025-08-29

### Diperbaiki (Keamanan)
- **Sanitasi Input**: Memperkuat keamanan di `RoleController` dengan mengganti `trim()` sederhana dengan `htmlspecialchars()` untuk membersihkan input `role_name` dari pengguna. Ini mencegah potensi serangan XSS.

## [5.0.4] - 2025-08-29

### Peningkatan
- **Refactoring Otentikasi**: Memusatkan logika pemeriksaan otentikasi yang berulang di `XorAdminController.php` ke dalam satu metode privat `requireAuth()`. Ini mengurangi duplikasi kode dan meningkatkan keterbacaan serta pemeliharaan.

## [5.0.3] - 2025-08-29

### Diperbaiki
- **Kode Redundan Dihapus**: Menghapus pemeriksaan `if ($result === false)` yang tidak perlu dari `XorAdminController.php`. Pemeriksaan ini tidak akan pernah tercapai karena `TelegramAPI` dirancang untuk melempar `Exception` saat terjadi kegagalan, yang sudah ditangani oleh blok `try-catch` di sekitarnya.

## [5.0.2] - 2025-08-29

### Diperbaiki (Keamanan)
- **Perbandingan Password Aman**: Mengganti perbandingan password yang rentan terhadap serangan waktu (`===`) dengan fungsi `hash_equals()` di `XorAdminController.php`. Ini memastikan perbandingan string dilakukan dalam waktu konstan, yang merupakan praktik keamanan standar untuk melindungi rahasia.

## [5.0.1] - 2025-08-29

### Peningkatan
- **Halaman Akses Ditolak yang Lebih Baik**: Mengganti pesan "Akses Ditolak" berbasis teks biasa dengan halaman HTML yang ramah pengguna. Halaman baru ini memberikan instruksi yang jelas kepada pengguna untuk login kembali melalui bot Telegram dan secara dinamis menyertakan tautan ke bot jika tersedia.

## [5.0.0] - 2025-08-28

### Diubah (Refactoring Arsitektur)
- **Implementasi Pola Model-View-Controller-Router (MVCR)**: Memulai refactoring besar-besaran pada arsitektur aplikasi dari struktur PHP native menjadi pola MVCR untuk meningkatkan modularitas, keterbacaan, dan kemudahan pemeliharaan.
  - **Router & Front Controller**: Memperkenalkan `public/index.php` sebagai satu-satunya titik masuk (front controller) dan `core/Router.php` untuk menangani semua permintaan web. Ini memungkinkan penggunaan URL yang bersih (misalnya, `/admin/dashboard`).
  - **Struktur Direktori Baru**: Membuat struktur direktori baru (`src/Controllers`, `src/Views`, `src/Models`, `public`) untuk memisahkan tanggung jawab dengan jelas.
  - **BaseController**: Membuat `BaseController` yang menangani logika umum seperti otentikasi sesi admin dan rendering view, yang akan diwarisi oleh semua controller lain.
  - **Refactor Dasbor Admin**: Halaman pertama yang berhasil di-refactor adalah Dasbor Percakapan Admin (`admin/index.php`). Logika bisnisnya sekarang berada di `Admin/DashboardController.php`, dan presentasinya di `src/Views/admin/dashboard/index.php` dengan layout terpusat.
- **Lanjutan Refactoring**: Melanjutkan refactoring dengan memigrasikan halaman "Kelola Bot" (`admin/bots.php`) dan "Edit Bot" (`admin/edit_bot.php`) ke `BotController` baru. Juga memulai refactoring area member dengan membuat `MemberBaseController` dan memigrasikan halaman "Dasbor Member" (`member/dashboard.php`).
- **Alur Login Member**: Menyelesaikan refactoring area member dengan memigrasikan halaman login (`member/index.php`) ke `Member/LoginController` yang baru, membuat alur otentikasi member sepenuhnya dikelola oleh arsitektur MVCR.
- **Manajemen Pengguna**: Halaman manajemen pengguna (`admin/users.php`) telah dimigrasikan ke `UserController`, mendukung fungsionalitas pencarian, pengurutan, dan paginasi dalam arsitektur baru.
- **Manajemen Konten Member**: Melanjutkan refactoring area member dengan memigrasikan halaman "Konten Saya" (`member/my_content.php`) dan "Edit Paket" (`member/edit_package.php`) ke dalam `ContentController`.
- **Halaman Chat Admin**: Memigrasikan halaman chat admin (`admin/chat.php`) dan fungsionalitas hapus pesan ke `ChatController`, membuat alur kerja inti ini sesuai dengan arsitektur MVCR.
- **Halaman Chat Channel**: Melengkapi refactoring fitur chat dengan memigrasikan halaman chat channel (`admin/channel_chat.php`) ke metode baru di dalam `ChatController`.
- **Penyelesaian Area Member**: Menyelesaikan semua halaman di area member (`channels.php`, `purchased.php`, `sold.php`, `view_package.php`) dengan memigrasikannya ke dalam controller dan view yang sesuai.
- **Lanjutan Refactor Admin**: Melanjutkan migrasi area admin dengan merefaktor halaman 'Manajemen Konten' (`admin/packages.php`).
- **Halaman Log Admin**: Memigrasikan semua halaman penampil log (`logs.php`, `media_logs.php`, `telegram_logs.php`) ke dalam `LogController` baru untuk konsistensi.
- **Migrasi AJAX ke API Controller**: Memigrasikan semua endpoint AJAX lama (misalnya, `api/update_user_roles.php`, `webhook_manager.php`, `package_manager.php`) ke dalam metode API yang sesuai di dalam controller yang ada, membuat semua interaksi backend konsisten dengan pola MVCR.
- **Lanjutan Refactor Admin**: Melanjutkan migrasi dengan merefaktor halaman 'Analitik' (`admin/analytics.php`) dan 'Manajemen Saldo' (`admin/balance.php`) beserta endpoint-endpoint API terkaitnya.
- **Penyelesaian Refactor Admin**: Menyelesaikan migrasi penuh area admin dengan merefaktor halaman 'Channel Penyimpanan' (`admin/channels.php`) dan 'Manajemen Peran' (`admin/roles.php`), membuat semua fungsionalitas admin kini berjalan di bawah arsitektur MVCR yang baru.
- **Penyelesaian Refactoring Total**: Menyelesaikan migrasi semua sisa halaman legacy, termasuk halaman admin (`database`, `sales_channels`, `api_test`, `debug_feed`), halaman root (`login_choice`, `xoradmin`), dan yang paling penting, titik masuk utama `webhook.php`. Seluruh fungsionalitas web dan bot sekarang berjalan sepenuhnya di bawah arsitektur MVCR yang baru. Direktori `admin/` dan `partials/` yang usang telah dihapus.
